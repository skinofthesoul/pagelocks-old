class PageLocksAdmin{async readLocks(){let e;try{const t=new FormData;t.append("readLocks",""),e=await fetch(window.location.pathname,{method:"POST",body:t})}catch(e){return void alert("Unexpected error while accessing the server.")}if(e.ok){const t=await e.json();0===Object.keys(t.locks).length&&this.alert(t.countAlert,"info"),this.displayLocks(t)}else alert("No valid response from server.")}displayLocks(e){const t=document.getElementById("locklist");t.innerHTML="",Object.keys(e.locks).forEach((a,s)=>{const n=e.locks[a],o=new Date(1e3*n.timestamp),c=document.createElement("tr");c.innerHTML=`\n            <td class="author">${n.fullname}</td>\n            <td class="route">${a}</td>\n            <td class="since">${o.toLocaleTimeString()}</td>\n            <td id="row${s}" class="delete">\n                <a href="#delete" \n                    class="page-delete delete-action" \n                    title="Delete Item"\n                    >\n                    <i class="fa fa-close"></i>\n                </a>\n            </td>\n            `,t.appendChild(c),document.getElementById("row"+s).addEventListener("click",()=>{window.confirm(e.alert.replace("%s",n.fullname))&&this.removeLock(a)})})}async removeLock(e){let t;try{const a=new FormData;a.append("forceRemoveLock",e),t=await fetch(window.location.pathname,{method:"POST",body:a})}catch(e){return void alert("Unexpected error while accessing the server.")}if(this.clearAlerts(),t.ok){const e=await t.json();e.isLockRemoved?this.alert(e.alert,"info"):this.alert(e.alert,"error"),this.readLocks()}else alert("No valid response from server.")}alert(e,t){const a=document.createElement("div");a.className=t+" alert pagelocks";const s=document.createTextNode(e);a.appendChild(s);document.getElementById("messages").appendChild(a)}clearAlerts(){const e=document.getElementsByClassName("alert pagelocks");for(let t of e){document.getElementById("messages").removeChild(t)}}}const admin=new PageLocksAdmin;admin.clearAlerts(),admin.readLocks();